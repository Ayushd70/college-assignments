CREATE TABLE SALESPEOPLE(
SNUM NUMBER PRIMARY KEY,
SNAME VARCHAR2(25),
CITY VARCHAR2(25),
COMM NUMBER);

CREATE TABLE CUSTOMER(
CNUM NUMBER PRIMARY KEY,
CNAME VARCHAR2(25),
CITY VARCHAR2(25),
RATING NUMBER,
SNUM NUMBER REFERENCES SALESPEOPLE(SNUM));

CREATE TABLE ORDER1(
ONUM NUMBER PRIMARY KEY,
AMT NUMBER,
ODATE DATE,
CNUM NUMBER REFERENCES CUSTOMER(CNUM),
SNUM NUMBER REFERENCES SALESPEOPLE(SNUM));

INSERT INTO SALESPEOPLE VALUES(100,'Aniket','Kolkata',1200);
INSERT INTO SALESPEOPLE VALUES(101,'Arnab','Chennai',1500);
INSERT INTO SALESPEOPLE VALUES(102,'Subhamm','Kolkata',2000);
INSERT INTO SALESPEOPLE VALUES(103,'Shounak','Mumbai',1600);
INSERT INTO SALESPEOPLE VALUES(104,'Triasa','Chennai',1200);
INSERT INTO SALESPEOPLE VALUES(105,'Madhurima','Delhi',2000);
INSERT INTO SALESPEOPLE VALUES(106,'Abheri','Kolkata',1600);
INSERT INTO SALESPEOPLE VALUES(107,'Sweeta','Lahore',1300);
INSERT INTO SALESPEOPLE VALUES(108,'Pom Pom','Mumbai',1000);
INSERT INTO SALESPEOPLE VALUES(109,'Aonki','Kolkata',900);

INSERT INTO CUSTOMER VALUES(200,'Aron Finch','Kolkata',6,100);
INSERT INTO CUSTOMER VALUES(201,'David Warner','Kolkata',5,101);
INSERT INTO CUSTOMER VALUES(202,'Smith Jones','Chennai',6,102);
INSERT INTO CUSTOMER VALUES(203,'Bruder Border','Bangalore',6,103);
INSERT INTO CUSTOMER VALUES(204,'Mikel Jackson','Kolkata',6,103);
INSERT INTO CUSTOMER VALUES(205,'Meghan Haynes','Delhi',1,105);
INSERT INTO CUSTOMER VALUES(206,'Ammy Ellen Jones','Mumbai',2,106);
INSERT INTO CUSTOMER VALUES(207,'Micheal Vaghuan','Mumbai',6,107);
INSERT INTO CUSTOMER VALUES(208,'Pinaky Roy','Kolkata',6,107);
INSERT INTO CUSTOMER VALUES(209,'Steven Smith','Lahore',5,109);

INSERT INTO ORDER1 VALUES(900, 1200, '17-Dec-2021', 201, 105);
INSERT INTO ORDER1 VALUES(901, 9802, '31-Dec-2021', 202, 101);
INSERT INTO ORDER1 VALUES(902, 1008, '27-Jan-2022', 203, 109);
INSERT INTO ORDER1 VALUES(903, 5698, '27-Jan-2022', 204, 105);
INSERT INTO ORDER1 VALUES(904, 3456, '6-Feb-2022',  204, 104);
INSERT INTO ORDER1 VALUES(905, 9230, '22-Feb-2022', 208, 102);
INSERT INTO ORDER1 VALUES(906, 564, '28-Feb-2022', 206, 106);
INSERT INTO ORDER1 VALUES(907, 1000, '13-Mar-2022', 202, 109);
INSERT INTO ORDER1 VALUES(908, 1680, '17-Mar-2022', 203, 107);
INSERT INTO ORDER1 VALUES(909, 121, '23-Apr-2022', 209, 103);

1. SELECT * FROM CUSTOMER WHERE RATING=(SELECT MAX(RATING) FROM CUSTOMER);

2. SELECT COUNT(SNUM) FROM SALESPEOPLE GROUP BY CITY;

3. SELECT SNUM,AVG(AMT),COUNT(ONUM) FROM ORDER1 GROUP BY SNUM;

4. SELECT SNUM FROM ORDER1 GROUP BY SNUM HAVING COUNT(CNUM)>1; 

5. CREATE VIEW SALESPEOPLE_CUSTOMER_ORDERS AS SELECT S.SNAME,C.CNAME,O.ONUM FROM SALESPEOPLE S,CUSTOMER C,ORDER1 O WHERE O.SNUM=S.SNUM AND O.CNUM=C.CNUM;

6. CREATE VIEW SALESPEOPLE_VIEW AS SELECT SNUM,COMM FROM SALESPEOPLE WHERE COMM>=1000 AND COMM<=2000 WITH CHECK OPTION;
